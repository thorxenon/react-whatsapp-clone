(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{38:function(e,t,a){},42:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),s=a(16),r=a.n(s),i=a(2),o=a.n(i),d=a(6),l=a(4),u=(a(38),a(21)),j=a(12),h=(a(39),a(40),j.a.initializeApp({apiKey:"AIzaSyDMDh5kDmPt56zDySt-BR2W0cvbayMGDO4",authDomain:"whatsapp-clonee-e8ddf.firebaseapp.com",projectId:"whatsapp-clonee-e8ddf",storageBucket:"whatsapp-clonee-e8ddf.appspot.com",messagingSenderId:"451955604559",appId:"1:451955604559:web:8784d0b3ec007253823e3a"})),b=h.firestore(),f={fbPopup:function(){var e=Object(d.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new j.a.auth.FacebookAuthProvider,e.next=3,h.auth().signInWithPopup(t);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),addUser:function(){var e=Object(d.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.collection("users").doc(t.id).set({name:t.name,avatar:t.avatar},{merge:!0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getContactList:function(){var e=Object(d.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.next=3,b.collection("users").get();case 3:return e.sent.forEach((function(e){var c=e.data();e.id!==t&&a.push({id:e.id,name:c.name,avatar:c.avatar})})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addNewChat:function(){var e=Object(d.a)(o.a.mark((function e(t,a){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.collection("chats").add({messages:[],users:[t.id,a.id]});case 2:c=e.sent,b.collection("users").doc(t.id).update({chats:j.a.firestore.FieldValue.arrayUnion({chatId:c.id,title:a.name,image:a.avatar,width:a.id})}),b.collection("users").doc(a.id).update({chats:j.a.firestore.FieldValue.arrayUnion({chatId:c.id,title:t.name,image:t.avatar,width:t.id})});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),onChatList:function(e,t){return b.collection("users").doc(e).onSnapshot((function(e){if(e.exists){var a=e.data();if(a.chats){var c=Object(u.a)(a.chats);c.sort((function(e,t){return void 0===e.lastMessageDate||void 0===t.lastMessageDate?-1:e.lastMessageDate.seconds<t.lastMessageDate.seconds?1:-1})),t(c)}}}))},onChatContent:function(e,t,a){return b.collection("chats").doc(e).onSnapshot((function(e){if(e.exists){var c=e.data();t(c.messages),a(c.users)}}))},sendMessage:function(){var e=Object(d.a)(o.a.mark((function e(t,a,c,n,s){var r,i,d,l,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Date,b.collection("chats").doc(t.chatId).update({messages:j.a.firestore.FieldValue.arrayUnion({type:c,author:a,body:n,date:r})}),e.t0=o.a.keys(s);case 3:if((e.t1=e.t0()).done){e.next=16;break}return i=e.t1.value,e.next=7,b.collection("users").doc(s[i]).get();case 7:if(d=e.sent,!(l=d.data()).chats){e.next=14;break}for(f in h=Object(u.a)(l.chats))h[f].chatId==t.chatId&&(h[f].lastMessage=n,h[f].lastMessageDate=r);return e.next=14,b.collection("users").doc(s[i]).update({chats:h});case 14:e.next=3;break;case 16:case"end":return e.stop()}}),e)})));return function(t,a,c,n,s){return e.apply(this,arguments)}}()},m=(a(42),a(0)),O=function(e){var t=e.onClick,a=e.active,n=e.data,s=Object(c.useState)(""),r=Object(l.a)(s,2),i=r[0],o=r[1];return Object(c.useEffect)((function(){if(n.lastMessageDate>0){var e=new Date(1e3*n.lastMessageDate.seconds),t=e.getHours(),a=e.getMinutes();a=a<10?"0"+a:a,o("".concat(t=t<10?"0"+t:t,":").concat(a))}}),[n]),Object(m.jsxs)("div",{className:"chat-list-item ".concat(a?"active":""),onClick:t,children:[Object(m.jsx)("img",{src:n.image,alt:"",className:"chat-list-item-avatar"}),Object(m.jsxs)("div",{className:"chat-list-item-lines",children:[Object(m.jsxs)("div",{className:"chat-list-item-line",children:[Object(m.jsx)("div",{className:"chat-list-item-name",children:n.title}),Object(m.jsx)("div",{className:"chat-list-item-date",children:i})]}),Object(m.jsx)("div",{className:"chat-list-item-line",children:Object(m.jsx)("div",{className:"chat-list-item-lastmsg",children:Object(m.jsx)("p",{children:n.lastMessage})})})]})]})},v=(a(44),function(){return Object(m.jsxs)("div",{className:"chat-intro-area",children:[Object(m.jsx)("img",{src:"/assets/inicial.png",alt:""}),Object(m.jsx)("h1",{children:"Mantenha seu celular conectado"}),Object(m.jsxs)("h2",{children:["O Whatsapp conecta ao seu telefone para sincronizar as suas mensagens. ",Object(m.jsx)("br",{})," Para reduzir o uso de dados, conecte seu telefone a uma rede Wi-Fi."]})]})}),x=a(22),p=a.n(x),w=(a(45),a(18)),g=a.n(w),N=a(24),y=a.n(N),k=a(19),C=a.n(k),S=a(26),D=a.n(S),I=a(25),M=a.n(I),E=a(28),L=a.n(E),P=a(27),R=a.n(P),U=(a(46),function(e){var t=e.data,a=e.user,n=Object(c.useState)(""),s=Object(l.a)(n,2),r=s[0],i=s[1];return Object(c.useEffect)((function(){if(t.date>0){var e=new Date(1e3*t.date.seconds),a=e.getHours(),c=e.getMinutes();c=c<10?"0"+c:c,i("".concat(a=a<10?"0"+a:a,":").concat(c))}}),[t]),Object(m.jsx)("div",{className:"message-line",style:{justifyContent:a.id==t.author?"flex-end":"flex-start"},children:Object(m.jsxs)("div",{className:"message-item",style:{backgroundColor:a.id===t.author?"#dcf8c6":"#fff"},children:[Object(m.jsx)("div",{className:"message-text",children:t.body}),Object(m.jsx)("div",{className:"message-date",children:r})]})})}),z=function(e){var t=e.user,a=e.data,n=Object(c.useRef)(),s=null,r=window.SpeechRecognition||window.webkitSpeechRecognition;void 0!==r&&(s=new r);var i=Object(c.useState)(!1),o=Object(l.a)(i,2),d=o[0],u=o[1],j=Object(c.useState)(""),h=Object(l.a)(j,2),b=h[0],O=h[1],v=Object(c.useState)(!1),x=Object(l.a)(v,2),w=x[0],N=x[1],k=Object(c.useState)([]),S=Object(l.a)(k,2),I=S[0],E=S[1],P=Object(c.useState)([]),z=Object(l.a)(P,2),F=z[0],H=z[1];Object(c.useEffect)((function(){return E([]),f.onChatContent(a.chatId,E,H)}),[a.chatId]),Object(c.useEffect)((function(){n.current.scrollHeight>n.current.offsetHeight&&(n.current.scrollTop=n.current.scrollHeight-n.current.offsetHeight)}),[I]);var B=function(){""!==b&&(f.sendMessage(a,t.id,"text",b,F),O(""),u(!1))};return Object(m.jsxs)("div",{className:"chat-window",children:[Object(m.jsxs)("div",{className:"chat-window-header",children:[Object(m.jsxs)("div",{className:"chat-window-header-info",children:[Object(m.jsx)("img",{className:"chat-window-avatar",src:a.image,alt:""}),Object(m.jsx)("div",{className:"chat-window-name",children:a.title})]}),Object(m.jsxs)("div",{className:"chat-window-header-buttons",children:[Object(m.jsx)("div",{className:"chat-window-btn",children:Object(m.jsx)(g.a,{style:{color:"#919191"}})}),Object(m.jsx)("div",{className:"chat-window-btn",children:Object(m.jsx)(y.a,{style:{color:"#919191"}})}),Object(m.jsx)("div",{className:"chat-window-btn",children:Object(m.jsx)(C.a,{style:{color:"#919191"}})})]})]}),Object(m.jsx)("div",{ref:n,className:"chat-window-body",children:I.map((function(e,a){return Object(m.jsx)(U,{data:e,user:t},a)}))}),Object(m.jsx)("div",{className:"chat-window-emojiarea",style:{height:d?"200px":"0px"},children:Object(m.jsx)(p.a,{onEmojiClick:function(e,t){O(b+t.emoji)},disableSearchBar:!0,disableSkinTonePicker:!0})}),Object(m.jsxs)("div",{className:"chat-window-footer",children:[Object(m.jsxs)("div",{className:"chat-window-pre",children:[Object(m.jsx)("div",{className:"chat-window-btn",onClick:function(){u(!1)},style:{width:d?40:0},children:Object(m.jsx)(M.a,{style:{color:"#919191"}})}),Object(m.jsx)("div",{className:"chat-window-btn",onClick:function(){u(!0)},children:Object(m.jsx)(D.a,{style:{color:d?"#009688":"#919191"}})})]}),Object(m.jsx)("div",{className:"chat-window-inputarea",children:Object(m.jsx)("input",{className:"chat-window-input",type:"text",placeholder:"Digite uma mensagem",value:b,onChange:function(e){return O(e.target.value)},onKeyUp:function(e){13==e.keyCode&&B()}})}),Object(m.jsxs)("div",{className:"chat-window-pos",children:[""===b&&Object(m.jsx)("div",{onClick:function(){null!==s&&(s.onstart=function(){N(!0)},s.onend=function(){N(!1)},s.onresult=function(e){O(e.results[0][0].transcript)},s.start())},className:"chat-window-btn",children:Object(m.jsx)(R.a,{style:{color:w?"#126ECE":"#919191"}})}),""!==b&&Object(m.jsx)("div",{onClick:B,className:"chat-window-btn",children:Object(m.jsx)(L.a,{style:{color:"#919191"}})})]})]})]})},F=(a(52),a(29)),H=a.n(F),B=function(e){var t=e.user,a=(e.chatList,e.show),n=e.setShow,s=Object(c.useState)([]),r=Object(l.a)(s,2),i=r[0],u=r[1],j=function(){n(!1)};Object(c.useEffect)((function(){var e=function(){var e=Object(d.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t){e.next=5;break}return e.next=3,f.getContactList(t.id);case 3:a=e.sent,u(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]);var h=function(){var e=Object(d.a)(o.a.mark((function e(a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.addNewChat(t,a);case 2:j();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"new-chat",style:{left:a?0:-415},children:[Object(m.jsxs)("div",{className:"new-chat-head",children:[Object(m.jsx)("div",{onClick:j,className:"new-chat-back-button",children:Object(m.jsx)(H.a,{style:{color:"#ffffff"}})}),Object(m.jsx)("div",{className:"new-chat-head-title",children:"Nova Conversa"})]}),Object(m.jsx)("div",{className:"new-chat-list",children:i.map((function(e,t){return Object(m.jsxs)("div",{onClick:function(){return h(e)},className:"new-chat-item",children:[Object(m.jsx)("img",{src:e.avatar,alt:"",className:"new-chat-item-avatar"}),Object(m.jsx)("div",{className:"new-chat-item-name",children:e.name})]})}))})]})},W=a(30),A=a.n(W),V=a(31),J=a.n(V),K=(a(53),function(e){var t=e.onReceive,a=function(){var e=Object(d.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.fbPopup();case 2:(a=e.sent)?t(a.user):alert("Error!");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"login",children:Object(m.jsx)("button",{onClick:a,children:"Logar com o Facebook"})})}),T=function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)({}),r=Object(l.a)(s,2),i=r[0],u=r[1],j=Object(c.useState)(null),h=Object(l.a)(j,2),b=h[0],x=h[1];Object(c.useEffect)((function(){if(null!==b)return f.onChatList(b.id,n)}),[b]);var p=Object(c.useState)(!1),w=Object(l.a)(p,2),N=w[0],y=w[1],k=function(){var e=Object(d.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t.uid,name:t.displayName,avatar:t.photoURL},e.next=3,f.addUser(a);case 3:x(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return null===b?Object(m.jsx)(K,{onReceive:k}):Object(m.jsxs)("div",{className:"app-window",children:[Object(m.jsxs)("div",{className:"side-bar",children:[Object(m.jsx)(B,{chatList:a,user:b,show:N,setShow:y}),Object(m.jsxs)("header",{children:[Object(m.jsx)("img",{className:"header-avatar",src:b.avatar,alt:""}),Object(m.jsxs)("div",{className:"header-buttons",children:[Object(m.jsx)("div",{className:"header-btn",children:Object(m.jsx)(A.a,{style:{color:"#919191"}})}),Object(m.jsx)("div",{onClick:function(){y(!0)},className:"header-btn",children:Object(m.jsx)(J.a,{style:{color:"#919191"}})}),Object(m.jsx)("div",{className:"header-btn",children:Object(m.jsx)(C.a,{style:{color:"#919191"}})})]})]}),Object(m.jsx)("div",{className:"search",children:Object(m.jsxs)("div",{className:"search-input",children:[Object(m.jsx)(g.a,{fontSize:"small",style:{color:"#919191"}}),Object(m.jsx)("input",{type:"search",placeholder:"Procurar ou come\xe7ar uma nova conversa"})]})}),Object(m.jsx)("div",{className:"chat-list",children:a.map((function(e,t){return Object(m.jsx)(O,{active:i.chatId===a[t].chatId,data:e,onClick:function(){return u(a[t])}},t)}))})]}),Object(m.jsxs)("div",{className:"content-area",children:[void 0!==i.chatId&&Object(m.jsx)(z,{user:b,data:i}),void 0===i.chatId&&Object(m.jsx)(v,{})]})]})};r.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)(T,{})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.60b40aec.chunk.js.map